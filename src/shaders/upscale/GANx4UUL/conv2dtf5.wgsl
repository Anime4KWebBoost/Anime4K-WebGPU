// Layer: Anime4K-v4.1-Upscale-GAN-x4-(UUL)-Conv-4x3x3x3
// Name: conv2dtf5
// Inputs: ['MAIN']
// Output: conv2d_tf5
@group(0) @binding(0) var MAIN_tex: texture_2d<f32>;
@group(0) @binding(1) var conv2d_tf5_tex: texture_storage_2d<rgba16float, write>;

fn go_0(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return textureLoad(MAIN_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0);
}

@compute
@workgroup_size(8, 8)
fn computeMain(@builtin(global_invocation_id) pixel: vec3u) {
  // OOB check
  let dim_out: vec2u = textureDimensions(conv2d_tf5_tex);
  if (pixel.x >= dim_out.x || pixel.y >= dim_out.y) {
    return;
  }
  
  var result: vec4f = vec4f(0.0);
  result += mat4x4<f32>(0.1363371, -0.15540521, -0.31718272, 0.016195117, -0.11684813, 0.035514772, 0.036139056, -0.07166461, 0.18743914, 0.2597766, 0.40419564, 0.18188365, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, -1);
  result += mat4x4<f32>(-0.3009684, 0.022765834, -0.18049309, -0.08467225, -0.38133445, 0.5031245, -0.08499587, -0.05829229, 0.29517335, 0.5049954, -0.34550402, 0.028938027, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, 0);
  result += mat4x4<f32>(0.08297039, 0.40598175, 0.17898728, 0.09962402, 0.144094, -0.63257754, -0.17135625, 0.040128335, -0.44739345, 0.2947188, 0.16830204, -0.042169526, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, 1);
  result += mat4x4<f32>(0.6079493, 0.10111115, 0.07312328, 0.32797632, 0.04438061, 0.13169874, -0.25383157, -0.2082139, -0.21848431, -0.6352441, -0.21146472, -0.16604403, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, -1);
  result += mat4x4<f32>(-0.072281, 0.15862514, 0.43191755, 0.11540132, 0.31328815, -0.5315003, -0.011417991, -0.05334168, -0.098632924, -0.1280698, 0.39636084, -0.22470373, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, 0);
  result += mat4x4<f32>(-0.09620375, 0.32031366, -0.28081584, -0.10667898, -0.22725722, 0.30929953, -0.13856508, 0.52870595, 0.3426154, -0.25681826, -0.5286905, 0.22251737, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, 1);
  result += mat4x4<f32>(-0.116833046, -0.010033731, -0.10660418, 0.20258091, -0.16682866, 0.10652147, 0.2892288, -0.46506444, 0.11439509, -0.087319046, 0.13385743, 0.018403474, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, -1);
  result += mat4x4<f32>(0.25397176, 0.06900933, -0.032205634, -0.35559848, -0.4572871, 0.04391792, -0.079241835, 0.23730846, -0.14349656, 0.29821903, -0.12540016, 0.017602116, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, 0);
  result += mat4x4<f32>(0.10184281, -0.4598769, -0.037037294, -0.0764841, -0.019283077, 0.07611817, 0.4753825, 0.3533474, 0.0929917, -0.07361922, -0.08772396, 0.054960705, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, 1);
  result += vec4f(-0.01772409, 0.0043326668, -0.0016441033, 0.045143403);
  textureStore(conv2d_tf5_tex, pixel.xy, result);
}
