// Layer: Anime4K-v4.1-Restore-GAN-(UUL)-Conv-4x3x3x3
// Name: conv2dtf
// Inputs: ['MAIN']
// Output: conv2d_tf
@group(0) @binding(0) var MAIN_tex: texture_2d<f32>;
@group(0) @binding(1) var conv2d_tf_tex: texture_storage_2d<rgba16float, write>;

fn go_0(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return textureLoad(MAIN_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0);
}

@compute
@workgroup_size(8, 8)
fn computeMain(@builtin(global_invocation_id) pixel: vec3u) {
  // OOB check
  let dim_out: vec2u = textureDimensions(conv2d_tf_tex);
  if (pixel.x >= dim_out.x || pixel.y >= dim_out.y) {
    return;
  }
  
  var result: vec4f = vec4f(0.0);
  result += mat4x4<f32>(-0.011550553, 0.2571523, -0.16894904, -0.09610124, -0.052744195, 0.30938542, 0.21441698, 0.2569063, 0.06468069, 0.089650966, 0.0748017, -0.018602168, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, -1);
  result += mat4x4<f32>(0.17143345, 0.051090688, -0.040205717, 0.23977952, -0.06845662, 0.11059154, 0.27167943, 0.039820686, -0.037420645, 0.32412684, 0.114460744, 0.19145139, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, 0);
  result += mat4x4<f32>(-0.18283899, 0.16125157, -0.29441658, -0.14905207, 0.19206345, -0.03641905, -0.0255512, -0.1973209, 0.096413575, -0.165314, 0.09896132, -0.023077995, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, 1);
  result += mat4x4<f32>(-0.03697045, 0.16279477, -0.22278853, -0.111244164, 0.12984428, -0.016251296, 0.06175422, -0.38215196, -0.020128965, -0.1455273, -0.08009769, 0.25073814, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, -1);
  result += mat4x4<f32>(-0.5884801, -0.6035645, 0.29799506, 0.15807843, -0.7622044, -0.15211694, 0.02642718, 0.08056384, -0.019515019, -0.08969495, 0.05972669, -0.56973815, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, 0);
  result += mat4x4<f32>(0.5292328, -0.12033433, 0.1487622, -0.016836211, 0.18644744, -0.1327393, 0.1285929, -0.25551647, 0.1799259, 0.041404646, -0.20043947, -0.3026472, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, 1);
  result += mat4x4<f32>(-0.024188336, -0.054328248, -0.12121459, 0.17569984, 0.0269405, -0.068125665, -0.12267483, -0.03206367, 0.010800722, 0.06791396, 0.21666309, 0.00086910516, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, -1);
  result += mat4x4<f32>(0.11299782, 0.16244878, 0.050983112, -0.20673744, 0.0814762, -0.290341, -0.13428551, 0.02317926, -0.23702003, -0.057354085, -0.16910575, 0.12039626, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, 0);
  result += mat4x4<f32>(0.0099286465, -0.01866624, -0.01341757, 0.040368155, 0.29543665, 0.20391521, 0.015693977, 0.024313066, -0.009628433, 0.014835176, -0.05416802, -0.049118232, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, 1);
  result += vec4f(0.009906447, 0.016014593, -0.015037731, 0.019793766);
  textureStore(conv2d_tf_tex, pixel.xy, result);
}
