// Layer: Anime4K-v4.1-Restore-GAN-(UUL)-Conv-4x3x3x16
// Name: conv2d1tf1
// Inputs: ['conv2d_tf', 'conv2d_tf1']
// Output: conv2d_1_tf1
@group(0) @binding(0) var conv2d_tf_tex: texture_2d<f32>;
@group(0) @binding(1) var conv2d_tf1_tex: texture_2d<f32>;
@group(0) @binding(2) var conv2d_1_tf1_tex: texture_storage_2d<rgba16float, write>;
fn max4(vector: vec4f, value: f32) -> vec4f {
  return max(vector, vec4f(value));
}

fn go_0(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(textureLoad(conv2d_tf_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}

fn go_1(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(textureLoad(conv2d_tf1_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}

fn go_2(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(-textureLoad(conv2d_tf_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}

fn go_3(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return max4(-textureLoad(conv2d_tf1_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0), 0.0);
}


@compute
@workgroup_size(8, 8)
fn computeMain(@builtin(global_invocation_id) pixel: vec3u) {
  // OOB check
  let dim_out: vec2u = textureDimensions(conv2d_1_tf1_tex);
  if (pixel.x >= dim_out.x || pixel.y >= dim_out.y) {
    return;
  }
  
  var result: vec4f = vec4f(0.0);
  result += mat4x4<f32>(-0.21144664, -0.21278776, 0.14495273, 0.40425083, 0.27247587, -0.109341, 0.033743903, 0.035514083, -0.39683792, 0.05346587, -0.164584, -0.27716008, 0.12337504, 0.06634312, 0.2134371, 0.6341114) * go_0(pixel.xy, -1, -1);
  result += mat4x4<f32>(0.13073774, -0.103435524, 0.0346405, 0.44462252, 0.11620409, 0.10156601, 0.054093704, -0.26547235, -0.11527728, 0.13799351, -0.027917054, -0.60904527, -0.07724007, -0.08113308, -0.009969666, 0.26369193) * go_0(pixel.xy, -1, 0);
  result += mat4x4<f32>(0.24912444, 0.0009965017, 0.04969851, 0.3003267, -0.003903703, -0.06769968, 0.10561507, -0.17234871, 0.1536697, -0.21829624, -0.017951855, -0.09118876, -0.22243726, 0.1614144, -0.024269601, 0.397888) * go_0(pixel.xy, -1, 1);
  result += mat4x4<f32>(0.06768992, -0.041342556, 0.07763352, -0.41787583, 0.031124283, 0.011633926, -0.0978459, 0.039305598, -0.41848403, -0.26259893, 0.28613627, 0.20371561, 0.58345675, -0.07080824, 0.19021916, 0.012531278) * go_0(pixel.xy, 0, -1);
  result += mat4x4<f32>(-0.20584361, 0.20292012, 0.16911204, -0.11723318, -0.06905249, -0.12639555, 0.029861137, -0.69824475, -0.15893462, 0.03822974, 0.2365254, -0.18049008, -0.54079545, 0.05378836, 0.3731226, -0.4194168) * go_0(pixel.xy, 0, 0);
  result += mat4x4<f32>(-0.16185144, 0.08044541, -0.11534125, -0.38361254, -0.18125655, 0.100682445, -0.17568061, 0.15932092, 0.4921224, -0.21809934, -0.4219327, 0.56603193, -0.11896117, 0.09941898, 0.060406428, -0.28055435) * go_0(pixel.xy, 0, 1);
  result += mat4x4<f32>(-0.17914674, -0.039117515, -0.10780753, -0.0019961328, -0.118028656, 0.13673705, 0.09796823, 0.036670703, 0.23708504, -0.217638, 0.02271306, -0.08260663, -0.02218291, 0.25449663, -0.38577145, 0.2289155) * go_0(pixel.xy, 1, -1);
  result += mat4x4<f32>(0.20697436, -0.08170284, -0.30875778, -0.091935694, -0.4299069, -0.048003297, 0.040368207, -0.11808018, 0.19754, -0.11251598, 0.27953205, 0.3021206, 0.45326826, 0.1854244, -0.29116857, -0.2648801) * go_0(pixel.xy, 1, 0);
  result += mat4x4<f32>(-0.005043171, 0.1165916, 0.035544373, -0.11442216, -0.17139262, -0.050638396, -0.26463476, 0.11100485, -0.10001776, -0.21563227, -0.16391662, -0.054651123, 0.39844766, 0.1455794, 0.017547537, -0.39557946) * go_0(pixel.xy, 1, 1);
  result += mat4x4<f32>(0.15157916, 0.18656601, -0.00782459, -0.038346134, -0.2450021, 0.047928028, -0.1472038, 0.2255333, -0.4334985, 0.08729366, 0.0846153, -0.30595127, -0.044211008, -0.08241214, -0.043064255, 0.4190449) * go_1(pixel.xy, -1, -1);
  result += mat4x4<f32>(0.05928101, -0.06261379, 0.038639594, 0.19335443, 0.07116561, -0.09511715, 0.2905441, 0.1801976, 0.26955184, -0.17377244, -0.1212788, 0.016638374, -0.22339019, 0.004929746, -0.09799133, -0.031665847) * go_1(pixel.xy, -1, 0);
  result += mat4x4<f32>(-0.18101548, 0.0012552696, -0.23048487, 0.112049505, -0.12021156, 0.14923924, 0.23487978, 0.09156211, 0.3823153, 0.19112724, -0.16386096, -0.33862537, 0.6392619, -0.074322194, -0.011328445, 0.010085967) * go_1(pixel.xy, -1, 1);
  result += mat4x4<f32>(0.14264163, -0.083046414, 0.05174603, -0.11164799, 0.5145514, 0.09971472, 0.07346141, -0.001808423, -0.26032692, -0.22621563, 0.055869855, 0.076288834, -0.010914596, 0.22231369, 0.10603505, -0.5869296) * go_1(pixel.xy, 0, -1);
  result += mat4x4<f32>(0.5548472, 0.12401844, -0.23502155, 0.0061489646, 0.67039174, 0.05105186, -0.37961176, -0.15655631, 0.2625075, 0.0843665, 0.15801008, 0.09782913, -1.1630117, 0.5171362, 0.29586038, -0.08990771) * go_1(pixel.xy, 0, 0);
  result += mat4x4<f32>(-0.5571424, -0.058150455, 0.07254807, -0.12936777, -0.12786071, 0.07129326, -0.241742, -0.08085487, -0.13637958, -0.22721592, -0.11745357, 0.112150125, -0.09672555, 0.27359635, -0.080746, -0.009863987) * go_1(pixel.xy, 0, 1);
  result += mat4x4<f32>(0.030648582, 0.065971114, 0.067242995, 0.22608843, -0.17207222, 0.054914985, 0.03116957, -0.052851222, 0.0069969087, -0.006153292, 0.21847431, 0.057503276, 0.8095128, -0.21049567, -0.006439858, 0.08432311) * go_1(pixel.xy, 1, -1);
  result += mat4x4<f32>(-0.042780217, -0.12338032, 0.05577247, -0.21822974, -0.17892684, 0.058537606, 0.080431335, -0.078834526, -0.31537804, -0.061866514, 0.023990609, -0.058277693, 0.097793244, -0.12215614, -0.13899407, 0.27879617) * go_1(pixel.xy, 1, 0);
  result += mat4x4<f32>(0.008304607, 0.034395944, 0.17608953, -0.06544607, -0.24016827, -0.0677199, 0.12737678, -0.05233579, 0.16614896, -0.14099626, -0.022224577, 0.14793196, -0.012446621, 0.028061012, -0.1716129, 0.060556497) * go_1(pixel.xy, 1, 1);
  result += mat4x4<f32>(0.5220798, 0.13444152, -0.2122427, -0.5736831, -0.20706674, 0.017248502, -0.028334714, 0.055140972, 0.33016387, -0.14287637, 0.01387342, 0.3571347, 0.28431186, 0.11765858, -0.01822439, -0.39872175) * go_2(pixel.xy, -1, -1);
  result += mat4x4<f32>(0.08728331, 0.23902069, -0.36302498, -0.16066715, -0.11230054, -0.13030538, 0.009534622, 0.048962418, 0.012431211, -0.20593752, -0.0013636881, 0.4360859, 0.04262531, 0.23974936, -0.094283335, -0.527438) * go_2(pixel.xy, -1, 0);
  result += mat4x4<f32>(0.030728528, -0.112231985, -0.009100498, -0.35143045, 0.16748357, 0.017510839, 0.03239966, 0.054478996, -0.17319912, -0.050375365, 0.089725465, 0.16103691, 0.10676163, -0.09278535, -0.05428266, -0.33354014) * go_2(pixel.xy, -1, 1);
  result += mat4x4<f32>(0.21258125, 0.04599829, -0.24325258, 0.029835198, 0.20194697, -0.07060258, 0.016639128, -0.3157998, 0.33405927, 0.060434584, -0.43728244, -0.062135965, 0.028998438, 0.11571891, -0.15109324, 0.07101858) * go_2(pixel.xy, 0, -1);
  result += mat4x4<f32>(-0.40383798, -0.36821288, 0.19626383, 0.59001976, 0.32839507, 0.101678796, 0.10640573, -0.10071399, -0.02920735, -0.0077641695, -0.22367977, -0.05433425, 0.004730477, 0.23157004, -0.11481708, 0.061465364) * go_2(pixel.xy, 0, 0);
  result += mat4x4<f32>(-0.08762416, -0.035775788, 0.26598835, 0.37357306, -0.11917872, 0.036915135, -0.19645864, -0.8743145, -0.51593053, 0.100978024, 0.06177629, -0.5311378, -0.09897961, -0.007981574, -0.14613442, 0.29796147) * go_2(pixel.xy, 0, 1);
  result += mat4x4<f32>(-0.08169756, 0.10602942, 0.16290301, 0.08642245, 0.14126572, 0.0143537, 0.022076355, 0.12719934, -0.115588315, 0.018044261, 0.06112664, -0.17315914, -0.24815254, 0.07138127, 0.064938284, 0.30757383) * go_2(pixel.xy, 1, -1);
  result += mat4x4<f32>(0.08658424, 0.04834558, 0.11189677, -0.11959915, 0.043204036, 0.0028814555, -0.27114293, 0.19655752, -0.06219229, -0.06335925, 0.001583622, 0.0003887524, -0.02551103, 0.1810684, -0.13473205, 0.41511175) * go_2(pixel.xy, 1, 0);
  result += mat4x4<f32>(0.098328196, -0.15463813, -0.25395435, 0.057165585, 0.12112806, 0.047703095, 0.1736894, -0.571335, -0.08877221, 0.25854358, -0.12695095, 0.057413366, -0.098884575, -0.28365913, 0.09991636, 0.22292562) * go_2(pixel.xy, 1, 1);
  result += mat4x4<f32>(-0.6112117, -0.010231417, -0.112239756, -0.07849118, 0.02083121, -0.034805223, 0.15247148, -0.12141691, 0.3277976, -0.06351269, -0.09261654, 0.48218137, -0.26786497, 0.18436286, 0.0026548437, -0.3494242) * go_3(pixel.xy, -1, -1);
  result += mat4x4<f32>(-0.095630266, 0.40209347, 0.037867773, -0.25989276, -0.011930034, 0.24516326, -0.0069997567, -0.3245564, -0.023615206, 0.15278822, -0.029383302, -0.7744169, 0.94101965, 0.056572374, 0.058212046, -0.061330616) * go_3(pixel.xy, -1, 0);
  result += mat4x4<f32>(0.081363745, -0.15472494, -0.34431493, 0.07395791, -0.055564385, 0.016541688, -0.08667468, -0.1444773, -0.2256494, -0.20606478, 0.4394829, 0.52758425, -0.5187416, 0.17331822, -0.27094364, -0.2181298) * go_3(pixel.xy, -1, 1);
  result += mat4x4<f32>(-0.287361, 0.16206776, 0.14063619, 0.13728833, -0.36886695, -0.08538228, 0.19503894, 0.11056105, 0.16406211, 0.01727046, 0.0871592, 0.07294414, 0.060550056, 0.061177608, -0.016883448, 0.30192128) * go_3(pixel.xy, 0, -1);
  result += mat4x4<f32>(-0.33929467, 0.13435748, 0.115937024, 0.067573994, 0.009863674, 0.013138309, 0.30058098, 0.10597743, -0.17499073, 0.05588405, 0.005677747, 0.40934527, 1.1545268, -0.155579, -0.13197516, 0.15191454) * go_3(pixel.xy, 0, 0);
  result += mat4x4<f32>(0.37388617, -0.08841946, -3.8818067e-05, -0.055153493, 0.10924964, 0.005106532, 0.2640823, 0.17689948, -0.078712486, 0.014336811, 0.13541687, -0.35125944, 0.25925586, -0.11574074, -0.05334974, 0.37477663) * go_3(pixel.xy, 0, 1);
  result += mat4x4<f32>(-0.09378358, -0.02469048, 0.09498973, -0.14765818, -0.06543113, 0.052611325, -0.038409166, -0.10529152, -0.19401579, -0.16219963, -0.16643663, -0.33105713, -0.47642896, 0.3563738, 0.10123918, 0.0047903634) * go_3(pixel.xy, 1, -1);
  result += mat4x4<f32>(-0.09347765, 0.13719639, 0.17906445, 0.20748247, 0.31409532, -0.033543803, -0.055865422, 0.20806772, -0.004353982, 0.15110697, -0.052026875, 0.04408309, -0.3727673, 0.08697647, 0.062118348, -0.12789507) * go_3(pixel.xy, 1, 0);
  result += mat4x4<f32>(0.17479336, -0.15061922, -0.039640546, 0.041190077, -0.060928237, 0.17590441, 0.13194624, 0.05623478, -0.16385348, 0.09232265, 0.035934143, -0.1263174, -0.35249633, 0.15528975, 0.10165315, -0.20805833) * go_3(pixel.xy, 1, 1);
  result += vec4f(-0.016027294, -0.022314552, 0.29750827, 0.022724666);
  textureStore(conv2d_1_tf1_tex, pixel.xy, result);
}
