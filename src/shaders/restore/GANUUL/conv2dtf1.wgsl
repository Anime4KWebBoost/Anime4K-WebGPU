// Layer: Anime4K-v4.1-Restore-GAN-(UUL)-Conv-4x3x3x3
// Name: conv2dtf1
// Inputs: ['MAIN']
// Output: conv2d_tf1
@group(0) @binding(0) var MAIN_tex: texture_2d<f32>;
@group(0) @binding(1) var conv2d_tf1_tex: texture_storage_2d<rgba16float, write>;

fn go_0(pos: vec2u, x_off: i32, y_off: i32) -> vec4f {
  return textureLoad(MAIN_tex, vec2i(i32(pos.x) + x_off, i32(pos.y) + y_off), 0);
}

@compute
@workgroup_size(8, 8)
fn computeMain(@builtin(global_invocation_id) pixel: vec3u) {
  // OOB check
  let dim_out: vec2u = textureDimensions(conv2d_tf1_tex);
  if (pixel.x >= dim_out.x || pixel.y >= dim_out.y) {
    return;
  }
  
  var result: vec4f = vec4f(0.0);
  result += mat4x4<f32>(-0.2907437, -0.077323735, -0.16973291, -0.16443132, 0.22864507, 0.49630427, 0.26739725, 0.032699764, 0.06087564, -0.20624332, 0.0112693785, 0.08255652, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, -1);
  result += mat4x4<f32>(0.06868092, -0.40196502, 0.13545038, 0.17964815, -0.05201233, -0.068510085, -0.033420287, 0.11053642, -0.22962584, 0.1240376, -0.07122576, -0.287889, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, 0);
  result += mat4x4<f32>(-0.08391916, 0.044837173, 0.05309633, -0.020162301, 0.21601973, 0.107087076, 0.009593669, -0.0480218, -0.0341008, 0.065055884, -0.037138876, 0.098079376, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, -1, 1);
  result += mat4x4<f32>(0.13852748, -0.41455564, 0.18791267, 0.092003055, 0.09786073, 0.13783242, -0.0740668, 0.24771707, -0.33705822, 0.14416842, 0.15743637, -0.2325511, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, -1);
  result += mat4x4<f32>(0.5497675, -0.29078907, 0.05763203, -0.04751569, -0.6902698, -0.19779761, -0.39250666, -0.00016204051, 0.5432319, 0.2619331, -0.46955073, -0.3574246, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, 0);
  result += mat4x4<f32>(-0.061908755, -0.19342895, 0.16516154, 0.034592014, -0.19078135, 0.17319767, -0.08530775, 0.30626982, 0.07117333, -0.13394159, -0.16021773, -0.25067675, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 0, 1);
  result += mat4x4<f32>(-0.08075159, -0.2351002, -0.16552883, 0.05863658, 0.016604373, 0.097477786, 0.06739595, 0.055863712, 0.1263199, 0.21669623, 0.14968488, -0.08309879, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, -1);
  result += mat4x4<f32>(0.29566878, -0.18975174, -0.31122676, 0.012913531, -0.14852591, 0.21946627, 0.34939107, 0.11229292, -0.065245174, 0.08148012, 0.3856815, -0.043731045, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, 0);
  result += mat4x4<f32>(0.03664222, 0.05616905, 0.16613087, -0.036628574, -0.0907965, 0.013615345, 0.0053964662, -0.015731616, -0.022957215, 0.10116718, -0.094957925, 0.058128193, 0.0, 0.0, 0.0, 0.0) * go_0(pixel.xy, 1, 1);
  result += vec4f(0.0017539978, -0.004052146, -0.0068221963, 0.0025597692);
  textureStore(conv2d_tf1_tex, pixel.xy, result);
}
