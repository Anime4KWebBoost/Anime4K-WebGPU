@group(0) @binding(0) var mySampler: sampler;
@group(0) @binding(1) var tex_0: texture_2d<f32>; // conv1ups
@group(0) @binding(2) var tex_1: texture_2d<f32>; // conv1ups1
@group(0) @binding(3) var tex_main: texture_2d<f32>; // inputTexture

fn max4(vector: vec4f, value: f32) -> vec4f {
  return max(vector, vec4f(value));
}

fn go_0(fragUV: vec2<f32>, x_off: f32, y_off: f32) -> vec4f {
    var uv = fragUV;
    var dim: vec2f = vec2f(textureDimensions(tex_0));
    uv += vec2f(x_off / dim.x, y_off / dim.y) * 0.66666666666666;
    return max4(textureSample(tex_0, mySampler, uv), 0.0);
}

fn go_1(fragUV: vec2<f32>, x_off: f32, y_off: f32) -> vec4f {
    var uv = fragUV;
    var dim: vec2f = vec2f(textureDimensions(tex_1));
    uv += vec2f(x_off / dim.x, y_off / dim.y) * 0.66666666666666;
    return max4(textureSample(tex_1, mySampler, uv), 0.0);
}

fn go_2(fragUV: vec2<f32>, x_off: f32, y_off: f32) -> vec4f {
    var uv = fragUV;
    var dim: vec2f = vec2f(textureDimensions(tex_0));
    uv += vec2f(x_off / dim.x, y_off / dim.y) * 0.66666666666666;
    return max4(-textureSample(tex_0, mySampler, uv), 0.0);
}

fn go_3(fragUV: vec2<f32>, x_off: f32, y_off: f32) -> vec4f {
    var uv = fragUV;
    var dim: vec2f = vec2f(textureDimensions(tex_1));
    uv += vec2f(x_off / dim.x, y_off / dim.y) * 0.66666666666666;
    return max4(-textureSample(tex_1, mySampler, uv), 0.0);
}

fn colorAt(fragUV: vec2<f32>) -> vec4f {
    return textureSample(tex_main, mySampler, fragUV);
}

@fragment
fn main(@location(0) fragUV: vec2<f32>) -> @location(0) vec4<f32> {
  var result: vec4f = mat4x4<f32>(-0.009692998, -0.008524317, 0.0010432196, 0.0, 0.00057165127, -0.011818117, 0.0014487396, 0.0, 0.0049518407, -0.001888361, -0.013262905, 0.0, 0.05004511, 0.023134997, -0.016969386, 0.0) * go_0(fragUV, -1.0, -1.0);
  result += mat4x4<f32>(0.008501838, -0.001176035, -0.0035942376, 0.0, 0.009015378, 0.011752493, 0.0061198603, 0.0, -0.056669727, -0.035067406, -0.040517025, 0.0, -0.039194923, 0.007251104, -0.0124227265, 0.0) * go_0(fragUV, -1.0, 0.0);
  result += mat4x4<f32>(0.010942934, 0.0100984, 0.0133265015, 0.0, -0.019482462, -0.014820488, -0.021098822, 0.0, -0.02860967, -0.10633767, -0.03296336, 0.0, -0.011277147, -0.007915212, 0.008589044, 0.0) * go_0(fragUV, -1.0, 1.0);
  result += mat4x4<f32>(-0.004447993, -0.0019008318, 0.0054705385, 0.0, -0.008042658, -0.0007432871, -0.0091506895, 0.0, 0.010537624, 0.047716837, 0.01504048, 0.0, -0.108882375, -0.06776622, -0.04354868, 0.0) * go_0(fragUV, 0.0, -1.0);
  result += mat4x4<f32>(-0.0030183722, 0.007729766, -0.007144855, 0.0, 0.029383881, 0.024865916, 0.028182652, 0.0, 0.16122057, 0.16675095, 0.18204775, 0.0, 0.12284804, 0.031072017, 0.042543165, 0.0) * go_0(fragUV, 0.0, 0.0);
  result += mat4x4<f32>(0.0012941018, -0.00043673834, 0.009252594, 0.0, 0.009156994, 0.0138289975, 0.015774839, 0.0, -0.051840767, -0.07687406, -0.069361895, 0.0, 0.017338578, 0.022834148, -0.0025963243, 0.0) * go_0(fragUV, 0.0, 1.0);
  result += mat4x4<f32>(0.01646397, 0.0028061832, 0.007990534, 0.0, -0.0073729097, -0.011168949, -0.0024975399, 0.0, -0.0066431006, -0.014508122, -0.005740217, 0.0, -0.06746655, -0.02083968, -0.05371696, 0.0) * go_0(fragUV, 1.0, -1.0);
  result += mat4x4<f32>(-0.013606154, 0.0062064505, 0.008410423, 0.0, 0.0038487792, 0.012054022, 0.007878108, 0.0, 0.034913104, -0.008084116, 0.014990575, 0.0, -0.005912989, 0.021872269, 0.055241022, 0.0) * go_0(fragUV, 1.0, 0.0);
  result += mat4x4<f32>(0.014251287, 0.0016604483, -0.006772879, 0.0, 0.0028646574, 0.0015996173, -0.002210879, 0.0, -0.0323296, 0.015729006, -0.017242312, 0.0, -0.03718726, -0.03889927, -0.041001298, 0.0) * go_0(fragUV, 1.0, 1.0);
  result += mat4x4<f32>(0.007536155, 0.009848646, 0.007846354, 0.0, 0.019176869, 0.019928271, 0.031777207, 0.0, 0.026086887, 0.01971131, -0.017595863, 0.0, 0.012899679, 0.0026994154, 0.008934449, 0.0) * go_1(fragUV, -1.0, -1.0);
  result += mat4x4<f32>(0.017639438, 0.01536491, 0.011161806, 0.0, 0.034244597, 0.025257796, 0.031185368, 0.0, -0.18240982, 0.038758054, 0.13050976, 0.0, -0.0075258785, -0.0034674285, 0.008525112, 0.0) * go_1(fragUV, -1.0, 0.0);
  result += mat4x4<f32>(0.01788933, 0.017623115, 0.020215526, 0.0, 0.0045994874, -0.0031487814, 0.003752946, 0.0, -0.06494309, -0.07747321, 0.06544584, 0.0, -0.004555707, -0.001776991, -0.017493976, 0.0) * go_1(fragUV, -1.0, 1.0);
  result += mat4x4<f32>(0.01359033, 0.02045422, 0.008234278, 0.0, -0.008073938, -0.036093507, -0.0027978886, 0.0, -0.37033105, 0.009709281, 0.28951523, 0.0, 0.003258166, 0.0044517294, -0.003740991, 0.0) * go_1(fragUV, 0.0, -1.0);
  result += mat4x4<f32>(-0.036449786, -0.03035285, -0.025356997, 0.0, 0.097153045, 0.10745537, 0.08421458, 0.0, 0.043944303, -0.004867672, -0.15142196, 0.0, 0.007044417, -0.00785739, 0.007504869, 0.0) * go_1(fragUV, 0.0, 0.0);
  result += mat4x4<f32>(-0.007951127, -0.008863303, -0.012213915, 0.0, 0.007273406, 0.00944796, -0.002621692, 0.0, 0.2919848, 0.06830943, -0.16119143, 0.0, -0.0033908382, 0.007383878, 0.007847461, 0.0) * go_1(fragUV, 0.0, 1.0);
  result += mat4x4<f32>(0.011670784, 0.00805604, 0.013980011, 0.0, -0.032067183, -0.045659855, -0.03957935, 0.0, 0.14678614, 0.014678316, -0.11203954, 0.0, -0.002894618, 0.008089503, 0.0056759617, 0.0) * go_1(fragUV, 1.0, -1.0);
  result += mat4x4<f32>(0.008941132, -0.008732514, -0.004122878, 0.0, -0.01872218, 0.0058594598, -0.014218105, 0.0, 0.15922345, -0.00061763515, -0.10605325, 0.0, 0.0059564817, 0.0062196897, -0.0031137357, 0.0) * go_1(fragUV, 1.0, 0.0);
  result += mat4x4<f32>(-0.027044835, -0.0113663385, -0.018061407, 0.0, -0.01064461, 0.0004394501, 0.0068360637, 0.0, 0.12218274, -0.025980305, 0.060082816, 0.0, 0.002298275, -0.005121948, -0.0018933173, 0.0) * go_1(fragUV, 1.0, 1.0);
  result += mat4x4<f32>(-0.014044151, -0.0055593867, -0.0091519095, 0.0, 0.018282808, -0.054974634, -0.02104256, 0.0, 0.004737865, 0.009833153, 0.0050819647, 0.0, 0.009256364, 0.004517343, -0.0012567915, 0.0) * go_2(fragUV, -1.0, -1.0);
  result += mat4x4<f32>(0.035084303, 0.019331766, -0.006399992, 0.0, -0.08042094, -0.14020248, -0.13438301, 0.0, -0.0014871466, -0.0071605383, -0.0070841024, 0.0, 0.001705956, -0.010914731, -0.0022737188, 0.0) * go_2(fragUV, -1.0, 0.0);
  result += mat4x4<f32>(-0.024562238, -0.025555398, 0.00043982622, 0.0, 0.04687896, 0.062265635, 0.06194832, 0.0, 0.016357735, 0.0056735775, 0.01868422, 0.0, 0.0035063815, 0.0050708377, 0.009102912, 0.0) * go_2(fragUV, -1.0, 1.0);
  result += mat4x4<f32>(0.024276884, 0.031309772, 0.053946678, 0.0, 0.027081756, 0.023922514, 0.051302873, 0.0, -0.005081098, -0.013981954, -0.007141123, 0.0, -0.017242068, -0.00036468913, 0.0071311933, 0.0) * go_2(fragUV, 0.0, -1.0);
  result += mat4x4<f32>(0.096000426, 0.12978247, 0.089689955, 0.0, 0.03013154, 0.09065384, 0.010782777, 0.0, -0.009774296, -0.010487119, -0.018002238, 0.0, 0.027585275, 0.018800229, 0.007482455, 0.0) * go_2(fragUV, 0.0, 0.0);
  result += mat4x4<f32>(-0.031725004, -0.05638542, -0.06471826, 0.0, -0.038512804, -0.036520924, -0.026658544, 0.0, 0.0019714478, 0.004168433, 0.0036675548, 0.0, 0.009312959, -0.009726487, 0.003937418, 0.0) * go_2(fragUV, 0.0, 1.0);
  result += mat4x4<f32>(0.008056586, -0.03609238, -0.0035044104, 0.0, -0.0052967947, 0.010446542, 0.010737699, 0.0, -0.00941154, -0.005599727, -0.0071648047, 0.0, 0.0028106347, 0.0063315486, 0.0005620387, 0.0) * go_2(fragUV, 1.0, -1.0);
  result += mat4x4<f32>(-0.10104362, -0.06228799, -0.057575073, 0.0, -0.0008651546, -0.010849562, -0.0066441186, 0.0, -0.016244762, -0.0053532585, -0.012414173, 0.0, -0.012507298, 0.005470365, 0.0032063425, 0.0) * go_2(fragUV, 1.0, 0.0);
  result += mat4x4<f32>(-0.019126823, -0.022827078, -0.01918732, 0.0, -0.0049576303, -0.010899637, -0.01990915, 0.0, 0.019013962, 0.007385637, 0.015615745, 0.0, 0.025586424, 0.02317941, 0.019631773, 0.0) * go_2(fragUV, 1.0, 1.0);
  result += mat4x4<f32>(-0.011578009, -0.0037521352, -0.0044622095, 0.0, -0.0022668878, 0.0022691146, -0.00570573, 0.0, 0.0052153515, 0.005547525, 0.0033032992, 0.0, 0.009927488, -0.0061824876, -0.016856432, 0.0) * go_3(fragUV, -1.0, -1.0);
  result += mat4x4<f32>(-0.07627339, -0.0595728, -0.08247348, 0.0, -0.016201988, -0.019643232, -0.021891698, 0.0, -0.0033560628, 0.0056153075, 0.005510208, 0.0, -0.0061155884, 0.004726241, 0.03613314, 0.0) * go_3(fragUV, -1.0, 0.0);
  result += mat4x4<f32>(-0.026918657, -0.017315133, -0.021586075, 0.0, -0.021625597, -0.008547036, -0.011233614, 0.0, -0.0047514364, -0.0029167454, -0.00583421, 0.0, 0.012949899, 0.0035817428, -0.0045735473, 0.0) * go_3(fragUV, -1.0, 1.0);
  result += mat4x4<f32>(-0.08581085, -0.07063111, -0.06381294, 0.0, -0.0040735947, -0.012934923, -0.0057904166, 0.0, -0.0077691195, -0.00034605907, 0.0023017807, 0.0, -0.00029635165, -0.042357627, -0.057994146, 0.0) * go_3(fragUV, 0.0, -1.0);
  result += mat4x4<f32>(0.05193261, 0.047533646, 0.071092665, 0.0, -0.015042884, -0.023481138, -0.020945435, 0.0, 0.008216166, 0.004034294, 0.0030410702, 0.0, 0.10532969, 0.13052966, 0.11042539, 0.0) * go_3(fragUV, 0.0, 0.0);
  result += mat4x4<f32>(0.052652936, 0.045103617, 0.036393207, 0.0, 0.0018712351, -0.009865708, -0.00591473, 0.0, -0.0008652197, 7.966737e-05, -0.004292879, 0.0, -0.013765752, -0.0603564, 0.032057546, 0.0) * go_3(fragUV, 0.0, 1.0);
  result += mat4x4<f32>(0.0020095943, -0.014555452, -0.008721001, 0.0, 0.00085926603, -0.0012287357, 0.007974135, 0.0, 0.004697991, -1.4738258e-05, -0.0048043244, 0.0, 0.047545042, 0.099660076, 0.09649951, 0.0) * go_3(fragUV, 1.0, -1.0);
  result += mat4x4<f32>(0.024352267, 0.03303334, 0.02903438, 0.0, 0.0062978864, 0.014672455, 0.0043003284, 0.0, -0.0017531263, -0.0032476797, 0.001345206, 0.0, -0.20736417, -0.1745426, -0.32957983, 0.0) * go_3(fragUV, 1.0, 0.0);
  result += mat4x4<f32>(0.027512033, 0.029760962, 0.033007182, 0.0, 9.0356014e-05, 0.0061743665, 0.0036443318, 0.0, -0.016802983, -0.019364875, -0.014311061, 0.0, 0.021530075, 0.059616566, 0.07120056, 0.0) * go_3(fragUV, 1.0, 1.0);
  result += vec4f(-0.0007544955, -0.0007692414, 0.00032997545, 0.0);
  result += colorAt(fragUV);

  return clamp(result, vec4<f32>(0., 0., 0., 0.), vec4<f32>(1., 1., 1., 1.));
}
